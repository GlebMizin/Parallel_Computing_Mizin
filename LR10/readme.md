***

# ОТЧЕТ

## Лабораторная работа №10: 2D задача теплопроводности. 1D и 2D декомпозиция области (MPI)

### Сведения о студенте

* **Дата:** 2025-12-28
* **Семестр:** 1
* **Группа:** ПИН-м-о-25-1 (1)
* **Дисциплина:** Параллельные вычисления
* **Студент:** Мизин Глеб Егорович

***

## 1. Цель работы

Реализовать параллельное решение 2D задачи (явная разностная схема) и сравнить два подхода распараллеливания:

* **1D-декомпозиция** области (деление по одному направлению),
* **2D-декомпозиция** области (деление по двум направлениям с декартовой топологией).

Измерить время выполнения и оценить ускорение/эффективность.

---

## 2. Постановка задачи (кратко)

На прямоугольной области задана 2D задача, вычисляемая по явной разностной схеме на сетке `(Nx+1) × (Ny+1)` в течение `M` шагов по времени. На каждом шаге значение в узле зависит от соседей по `x` и `y`, поэтому при распараллеливании требуется обмен граничными данными (halo).

---

## 3. Реализация

### 3.1. 1D-декомпозиция

Область делится по направлению `x` на полосы. Каждый процесс хранит полосу `nx_loc × (Ny+1)` + две ghost-строки по `x`.
На каждом шаге выполняется обмен граничных строк с соседними процессами через `Sendrecv`.

### 3.2. 2D-декомпозиция

Процессы организуются в решётку `q×q` (декартова топология), область делится на блоки по `x` и `y`.
Каждый процесс хранит блок `(nx_loc × ny_loc)` + halo по всем четырём сторонам.
На каждом шаге выполняются обмены:

* строками вверх/вниз,
* столбцами влево/вправо
  (обмен столбцами выполняется через упаковку в contiguous буфер).

Использованные MPI операции: `Create_cart`, `Shift`, `Sendrecv`, `Barrier`, `Allreduce(MAX)`.

---

## 4. Параметры эксперимента

* `Nx = 50`
* `Ny = 50`
* `M = 500`

---

## 5. Запуск

### 1D

```bash
mpiexec -n 1 python lr10_heat2d.py --mode 1d --Nx 50 --Ny 50 --M 500
mpiexec -n 2 python lr10_heat2d.py --mode 1d --Nx 50 --Ny 50 --M 500
mpiexec -n 4 python lr10_heat2d.py --mode 1d --Nx 50 --Ny 50 --M 500
mpiexec -n 8 python lr10_heat2d.py --mode 1d --Nx 50 --Ny 50 --M 500
```

### 2D

```bash
mpiexec -n 4 python lr10_heat2d.py --mode 2d --Nx 50 --Ny 50 --M 500
```

---

## 6. Результаты

### 6.1. 1D-декомпозиция: время

Время: `compute_time_max` (максимум по процессам).

|  p | T(p), сек |     checksum |
| -: | --------: | -----------: |
|  1 |  2.362495 | 1.166248e+03 |
|  2 |  1.282264 | 1.166248e+03 |
|  4 |  0.780528 | 1.166248e+03 |
|  8 |  0.612311 | 1.166248e+03 |

### 6.2. 1D-декомпозиция: ускорение и эффективность

`T(1) = 2.362495`
Формулы:

* `S(p) = T(1)/T(p)`
* `E(p) = S(p)/p`

|  p | Speedup S(p) | Efficiency E(p) |
| -: | -----------: | --------------: |
|  1 |        1.000 |           1.000 |
|  2 |        1.842 |           0.921 |
|  4 |        3.027 |           0.757 |
|  8 |        3.858 |           0.482 |

---

### 6.3. 2D-декомпозиция (2×2): время

|  p | grid | T(p), сек |     checksum |
| -: | ---- | --------: | -----------: |
|  4 | 2×2  |  0.842346 | 1.166248e+03 |

---

## 7. Анализ (коротко)

* В режиме **1D** получено ускорение до ~3.86 на 8 процессах, но эффективность падает из-за увеличения накладных расходов на обмен/синхронизацию.
* **2D** декомпозиция даёт более “локальные” обмены (только с 4 соседями) и лучше масштабируется на больших сетках, но при небольших размерах задачи и малом числе процессов может быть сопоставима или немного хуже из-за большего количества обменов (сразу по двум направлениям).
  В данном эксперименте при `p=4` 2D получилось немного медленнее 1D.

---

## 8. Заключение

Реализованы два варианта распараллеливания 2D задачи: 1D и 2D декомпозиция области. Выполнены измерения времени и рассчитаны ускорение/эффективность для 1D. Показано, что при малых размерах задачи 1D может быть выгоднее, а 2D подход перспективнее для более крупных сеток и большего числа процессов.

---